#!/bin/bash

# éƒ¨ç½²éªŒè¯è„šæœ¬
# ç”¨äºåœ¨æœ¬åœ°éªŒè¯æ–‡æ¡£ç«™ç‚¹æ„å»ºæ˜¯å¦æ­£å¸¸

set -e

echo "ğŸš€ å¼€å§‹éªŒè¯ LLM Link æ–‡æ¡£ç«™ç‚¹éƒ¨ç½²..."

# æ£€æŸ¥ Node.js ç‰ˆæœ¬
echo "ğŸ“‹ æ£€æŸ¥ Node.js ç‰ˆæœ¬..."
node --version
npm --version

# è¿›å…¥æ–‡æ¡£ç«™ç‚¹ç›®å½•
cd docs-site

# æ¸…ç†ä¹‹å‰çš„æ„å»º
echo "ğŸ§¹ æ¸…ç†ä¹‹å‰çš„æ„å»º..."
rm -rf build .svelte-kit

# å®‰è£…ä¾èµ–
echo "ğŸ“¦ å®‰è£…ä¾èµ–..."
npm ci

# æ„å»ºé¡¹ç›®
echo "ğŸ”¨ æ„å»ºé¡¹ç›®..."
npm run build

# æ£€æŸ¥æ„å»ºç»“æœ
echo "âœ… æ£€æŸ¥æ„å»ºç»“æœ..."
if [ -d "build" ]; then
    echo "âœ… æ„å»ºæˆåŠŸï¼"
    echo "ğŸ“Š æ„å»ºæ–‡ä»¶å¤§å°:"
    du -sh build/*
    
    echo "ğŸŒ é¢„è§ˆæ„å»ºç»“æœ (æŒ‰ Ctrl+C åœæ­¢):"
    npm run preview
else
    echo "âŒ æ„å»ºå¤±è´¥ï¼"
    exit 1
fi
